<!DOCTYPE html>
<html lang="de" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SANAABIL - Mit wenig viel bewirken. Eine private Spenden-Gemeinschaft.">
    <title>SANAABIL</title>
    
    <!-- Favicon -->
    <link rel="icon" href="https://i.imgur.com/7GqbuO4.jpeg" type="image/jpeg">
    
    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:ital,wght@0,600;1,600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* --- Dark Mode (Default / Seed State) --- */
            --bg-primary: #0f172a;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --accent-gold: #D4AF37;
            --accent-gold-light: #FDE68A;
            --glass-bg: rgba(30, 41, 59, 0.45);
            --glass-border: rgba(212, 175, 55, 0.15);
            --card-hover: rgba(212, 175, 55, 0.08);
            --roadmap-line: rgba(255, 255, 255, 0.05);
            --particle-color: 212, 175, 55;
            --profile-glow: rgba(212, 175, 55, 0.3);
            
            /* Success Badge Colors (Dark Mode) */
            --success-bg: rgba(20, 83, 45, 0.4);
            --success-text: #4ade80;
            --success-border: #166534;
        }
        /* --- Light Mode (Plant State / Weizen-Gelb) --- */
        body.light-mode {
            --bg-primary: #FEFCE8; 
            --text-primary: #3E2723;
            --text-secondary: #5D4037;
            --accent-gold: #B45309;
            --accent-gold-light: #D97706;
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(180, 83, 9, 0.2);
            --card-hover: rgba(180, 83, 9, 0.05);
            --roadmap-line: rgba(62, 39, 35, 0.1);
            --particle-color: 180, 83, 9;
            --profile-glow: rgba(180, 83, 9, 0.25);
            
            /* Success Badge Colors (Light Mode) */
            --success-bg: #dcfce7; 
            --success-text: #14532d; 
            --success-border: #86efac; 
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            overflow-x: hidden;
            overscroll-behavior: none;
            transition: background-color 0.6s cubic-bezier(0.4, 0, 0.2, 1), color 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        h1, h2, h3, blockquote {
            font-family: 'Playfair Display', serif;
        }
        /* Hintergrund-Partikel-Canvas */
        #particle-canvas {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; opacity: 0.4; pointer-events: none;
        }
        .glass-container {
            background-color: var(--glass-bg);
            backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 10px 40px -10px rgba(0, 0, 0, 0.1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative; z-index: 20;
        }
        .fade-in-section {
            opacity: 0; transform: translateY(20px);
            transition: opacity 0.8s ease-out, transform 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);
            transition-delay: var(--delay);
            will-change: opacity, transform; position: relative; z-index: 20;
        }
        .fade-in-section.is-visible { opacity: 1; transform: translateY(0); }
        /* Roadmap Styles */
        .roadmap-line-container {
            position: absolute; left: 15px; top: 0; bottom: 0; width: 2px; background: var(--roadmap-line);
        }
        @media (min-width: 640px) { .roadmap-line-container { left: 19px; } }
        .roadmap-progress-line {
            position: absolute; top: 0; left: 0; width: 100%; height: 0%;
            background: linear-gradient(180deg, var(--accent-gold), var(--accent-gold-light));
            box-shadow: 0 0 12px rgba(212, 175, 55, 0.6);
            transition: height 2.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .roadmap-item {
            opacity: 0; transform: translateX(-15px);
            transition: all 0.7s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative; z-index: 20;
        }
        .roadmap-item.active { opacity: 1; transform: translateX(0); }
        .roadmap-dot { transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); transform: scale(0); }
        .roadmap-item.active .roadmap-dot { transform: scale(1); }
        
        /* Progress Bar Animationen */
        .ramadan-progress-fill {
            transition: width 2.5s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        /* Optimierter Shine-Effekt */
        @keyframes shine-move {
            0% { transform: translateX(-150%) skewX(-15deg); }
            100% { transform: translateX(250%) skewX(-15deg); }
        }
        .animate-shine {
            animation: shine-move 3.5s infinite ease-in-out;
        }

        /* Aufruf-Sektion */
        .special-callout-container {
            background: linear-gradient(145deg, var(--glass-bg), transparent);
            border: 1px solid var(--glass-border);
            box-shadow: inset 0 0 30px var(--card-hover);
            position: relative; overflow: hidden; z-index: 20; transition: background 0.6s ease;
        }
        .special-callout-container::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px;
            background: linear-gradient(90deg, transparent, var(--accent-gold), transparent); opacity: 0.6;
        }
        .quote-text {
            font-size: 1.15rem; line-height: 1.8; color: var(--text-primary); font-style: italic; transition: color 0.5s ease;
        }
        @media (min-width: 768px) { .quote-text { font-size: 1.35rem; } }
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: var(--glass-border); border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--accent-gold); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        /* Loader */
        .custom-loader {
            width: 44px; height: 44px; border: 3px solid var(--glass-border);
            border-radius: 50%; border-top-color: var(--accent-gold);
            animation: spin 1s cubic-bezier(0.4, 0, 0.2, 1) infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        /* FAQ Modernisierung */
        .faq-item {
            background-color: var(--glass-bg); border: 1px solid var(--glass-border);
            border-radius: 0.75rem; transition: all 0.3s ease; overflow: hidden; position: relative; z-index: 20;
        }
        .faq-item:hover { border-color: var(--accent-gold); background-color: var(--card-hover); }
        .faq-item.active { border-color: var(--accent-gold); box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05); }
        .faq-content-wrapper { display: grid; grid-template-rows: 0fr; transition: grid-template-rows 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .faq-item.active .faq-content-wrapper { grid-template-rows: 1fr; }
        .faq-content { overflow: hidden; }
        .faq-icon { transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .faq-item.active .faq-icon { transform: rotate(180deg); color: var(--accent-gold); }
        /* Logo Animationen */
        .logo-static {
            box-shadow: 0 0 30px var(--profile-glow);
            animation: gentle-breathe 4s ease-in-out infinite alternate;
        }
        @keyframes gentle-breathe {
            0% { box-shadow: 0 0 20px var(--profile-glow); transform: scale(1); }
            100% { box-shadow: 0 0 40px var(--profile-glow); transform: scale(1.02); }
        }
        .pulse-active-dot {
            animation: pulse-gold-ring 2s cubic-bezier(0.25, 0.46, 0.45, 0.94) infinite;
            background-color: var(--accent-gold) !important; color: var(--bg-primary) !important; border-color: var(--accent-gold) !important;
        }
        @keyframes pulse-gold-ring {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(212, 175, 55, 0.6); }
            70% { transform: scale(1.1); box-shadow: 0 0 0 12px rgba(212, 175, 55, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(212, 175, 55, 0); }
        }
        /* Project Card Shine */
        .project-shine {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to right, transparent 0%, rgba(255,255,255,0.05) 50%, transparent 100%);
            transform: skewX(-20deg) translateX(-150%); transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1); pointer-events: none;
        }
        .group:hover .project-shine { transform: skewX(-20deg) translateX(150%); transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1); }
        .text-gradient-gold { background: linear-gradient(135deg, var(--accent-gold), var(--accent-gold-light)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        /* Wobble Switch */
        .switch-container { position: absolute; top: 1.5rem; right: 0.5rem; z-index: 100; transform: rotate(90deg); transform-origin: center; }
        .switch { --INITIAL-SWITCH-TRACK-COLOR: #1e293b; --INITIAL-THUMB-COLOR: #D4AF37; --OVERALL-TRANSITION-DURATION: 500ms; font-size: 8px; position: relative; display: inline-block; width: 3.75em; height: 2em; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--INITIAL-SWITCH-TRACK-COLOR); transition: var(--OVERALL-TRANSITION-DURATION); border-radius: 30px; overflow: hidden; border: 1px solid rgba(255, 255, 255, 0.1); }
        .slider:before { position: absolute; content: ""; height: 100%; aspect-ratio: 1; border-radius: 20px; left: 0; bottom: 0; background-color: var(--INITIAL-THUMB-COLOR); transition: var(--OVERALL-TRANSITION-DURATION); }
        .switch input:checked + .slider { background-color: var(--INITIAL-THUMB-COLOR); border-color: rgba(0,0,0,0.1); }
        .switch input:checked + .slider::before { transform-origin: left; background-color: var(--INITIAL-SWITCH-TRACK-COLOR); animation: wobble var(--OVERALL-TRANSITION-DURATION) cubic-bezier(0.075, 0.82, 0.165, 1); transform: scale(1, 1) translateX(1.75em); }
        .switch input:not(:checked) + .slider::before { transform-origin: right; animation: reverse-wobble var(--OVERALL-TRANSITION-DURATION) cubic-bezier(0.075, 0.82, 0.165, 1); }
        @keyframes wobble { 0% { transform: scale(1, 1); } 50% { transform: scale(3, 1); } 100% { transform: scale(1, 1) translateX(1.75em); } }
        @keyframes reverse-wobble { 0% { transform: scale(1, 1) translateX(1.75em); } 50% { transform: scale(3, 1); } 100% { transform: scale(1, 1) translateX(0); } }
    </style>
</head>
<body class="antialiased selection:bg-[var(--accent-gold)] selection:text-[var(--bg-primary)]">
    <!-- Wobble Switch Theme Toggle -->
    <div class="switch-container">
        <label class="switch" aria-label="Theme umschalten">
            <input type="checkbox" id="theme-toggle" />
            <span class="slider"></span>
        </label>
    </div>
    <!-- Hintergrund-Canvas -->
    <canvas id="particle-canvas" aria-hidden="true"></canvas>
    <!-- Ladebildschirm -->
    <div id="loader-container" class="fixed inset-0 bg-[var(--bg-primary)] flex justify-center items-center z-50 transition-opacity duration-700">
        <div class="custom-loader"></div>
    </div>
    <!-- Hauptinhalt -->
    <div id="content-container" class="hidden opacity-0 transition-opacity duration-1000 ease-out">
        
        <!-- Header Section -->
        <header class="text-center pt-20 pb-14 px-4 fade-in-section" style="--delay: 0.1s;">
            <div class="relative inline-block mb-8">
                <img src="https://i.imgur.com/7GqbuO4.jpeg" alt="SANAABIL Community Logo" class="w-32 h-32 md:w-44 md:h-44 mx-auto rounded-full logo-static object-cover border-2 border-[var(--glass-border)]" fetchpriority="high">
            </div>
            
            <h1 class="text-4xl md:text-6xl font-bold mb-4 tracking-widest uppercase text-gradient-gold drop-shadow-sm">
                SANAABIL
            </h1>
            <p class="text-xs md:text-sm font-medium tracking-[0.25em] text-[var(--text-secondary)] uppercase">
                Mit wenig viel bewirken
            </p>
        </header>
        <main class="max-w-4xl mx-auto px-5 pb-24 relative z-20">
            
            <!-- About Section -->
            <section class="glass-container p-8 md:p-10 rounded-2xl mb-14 fade-in-section" style="--delay: 0.2s;">
                <div class="flex items-center space-x-6 mb-8">
                    <div class="h-px flex-1 bg-gradient-to-r from-transparent to-[var(--accent-gold)] opacity-50"></div>
                    <h2 class="text-2xl md:text-3xl font-medium text-[var(--accent-gold)] text-center tracking-wide">Über unsere Gemeinschaft</h2>
                    <div class="h-px flex-1 bg-gradient-to-l from-transparent to-[var(--accent-gold)] opacity-50"></div>
                </div>
                
                <p class="text-center text-[var(--text-secondary)] font-serif text-xl mb-8">
                    بسم الله الرحمن الرحيم
                </p>
                <div class="text-[var(--text-primary)] space-y-6 leading-relaxed font-light text-[1.05rem]">
                    <p class="text-center italic opacity-90">
                        Das Gleichnis derjenigen, die ihren Besitz auf Allahs Weg ausgeben, ist das eines Saatkorns, das sieben Ähren wachsen läßt, (und) in jeder Ähre hundert Körner. Allah vervielfacht, wem Er will. Und Allah ist Allumfassend und Allwissend.
                    </p>
                    <div class="bg-[var(--card-hover)] p-6 rounded-xl border border-[var(--glass-border)] mt-6 shadow-inner">
                        <div class="flex items-center gap-2 mb-3">
                            <p class="font-semibold text-[var(--accent-gold)] text-lg">1€ Sadaqa:</p>
                        </div>
                        <p class="text-sm md:text-base text-[var(--text-secondary)] leading-relaxed">
                            Wir sind eine private Gemeinschaft, die gemeinsam durch kleine, monatliche Beiträge Gutes bewirken möchte. Diese Seite dient ausschließlich zur Präsentation unserer Arbeit, damit wir transparent zeigen können, was wir gemeinsam erreichen wollen in sha ALLAH.
                        </p>
                    </div>
                </div>
            </section>
            <!-- Ramadan Status Section -->
            <section class="glass-container p-8 md:p-10 rounded-2xl mb-24 fade-in-section" style="--delay: 0.25s;" id="ramadan-status-section">
                <div class="flex items-center space-x-6 mb-4">
                    <div class="h-px flex-1 bg-gradient-to-r from-transparent to-[var(--accent-gold)] opacity-50"></div>
                    <h2 class="text-2xl md:text-3xl font-medium text-[var(--accent-gold)] text-center tracking-wide flex items-center gap-3">
                        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
                        Ramadan Ziele
                    </h2>
                    <div class="h-px flex-1 bg-gradient-to-l from-transparent to-[var(--accent-gold)] opacity-50"></div>
                </div>
                
                <p class="text-center text-[var(--text-secondary)] mb-10 max-w-xl mx-auto text-sm md:text-base">
                    Verfolge unseren Fortschritt für unsere drei Spendenprojekte in diesem Monat. Jeder Euro bringt uns dem Ziel näher, in sha ALLAH!
                </p>
                <!-- Haupt-Fortschrittsbalken -->
                <div class="mb-12">
                    <div class="flex justify-between items-end mb-3">
                        <span class="text-[var(--text-primary)] font-medium text-sm md:text-base">
                            Bisher gesammelt: <span class="text-[var(--accent-gold)] text-2xl font-bold ml-1 tracking-wider">407 €</span>
                        </span>
                        <span class="text-[var(--text-secondary)] font-medium text-sm md:text-base">Ziel: 1.500 €</span>
                    </div>
                    <!-- Master Bar -->
                    <div class="h-7 w-full bg-[var(--bg-primary)] rounded-full border border-[var(--glass-border)] overflow-hidden relative shadow-inner">
                        <!-- 407/1500 = 27.13% -->
                        <div class="ramadan-progress-fill absolute left-0 top-0 h-full bg-gradient-to-r from-[var(--accent-gold-light)] to-[var(--accent-gold)] shadow-[0_0_20px_var(--accent-gold)]" style="width: 0%;" data-target="27.13%">
                            <!-- Optimierter Shine-Effekt Container -->
                            <div class="absolute inset-0 w-full h-full overflow-hidden">
                                <div class="absolute inset-0 w-[40%] h-full bg-gradient-to-r from-transparent via-white/40 to-transparent animate-shine"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 3 Projekte Karten -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-5">
                    
                    <!-- Mushaf (Erfolgreich) -->
                    <div class="p-5 md:p-6 rounded-xl border-2 border-[var(--accent-gold)] bg-[var(--card-hover)] relative overflow-hidden shadow-[0_0_25px_var(--profile-glow)] transition-transform hover:-translate-y-1">
                        <div class="absolute inset-0 bg-gradient-to-br from-[var(--accent-gold)] to-transparent opacity-10"></div>
                        
                        <!-- Erfolgreich Badge -->
                        <div class="absolute top-4 right-4 bg-[var(--accent-gold)] text-[var(--bg-primary)] text-[9px] md:text-[10px] font-bold px-2 py-1 rounded-full flex items-center shadow-lg">
                            <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>
                            ERFOLGREICH
                        </div>
                        
                        <h3 class="text-xl font-bold text-[var(--text-primary)] mb-1 relative z-10">Mushaf</h3>
                        <p class="text-[var(--text-secondary)] font-medium text-sm mb-4 relative z-10">300 € / 300 €</p>
                        
                        <!-- Voller Balken -->
                        <div class="h-2 w-full bg-[var(--bg-primary)] rounded-full overflow-hidden relative z-10">
                            <div class="h-full bg-[var(--accent-gold)] w-full"></div>
                        </div>
                        
                        <p class="text-xs text-[var(--accent-gold)] mt-3 font-serif text-right relative z-10 opacity-90 tracking-wide">
                            wa lillahi-l hamd
                        </p>
                    </div>
                    <!-- Brunnen (In Arbeit) -->
                    <div class="p-5 md:p-6 rounded-xl border border-[var(--glass-border)] bg-[var(--glass-bg)] relative transition-transform hover:-translate-y-1">
                        <h3 class="text-xl font-semibold text-[var(--text-primary)] mb-1">Brunnen</h3>
                        <!-- 407 - 300 = 107 -->
                        <p class="text-[var(--text-secondary)] font-medium text-sm mb-4">107 € / 600 €</p>
                        
                        <!-- Teil-Balken (107/600 = ~17.83%) -->
                        <div class="h-2 w-full bg-[var(--bg-primary)] rounded-full overflow-hidden relative">
                            <div class="ramadan-progress-fill absolute left-0 top-0 h-full bg-[var(--accent-gold)] rounded-full shadow-[0_0_5px_var(--accent-gold)]" style="width: 0%;" data-target="17.83%"></div>
                        </div>
                    </div>
                    <!-- Marrakesch (Ausstehend) -->
                    <div class="p-5 md:p-6 rounded-xl border border-[var(--glass-border)] bg-[var(--glass-bg)] relative opacity-70 transition-opacity hover:opacity-100">
                        <h3 class="text-xl font-semibold text-[var(--text-primary)] mb-1">Marrakesch</h3>
                        <p class="text-[var(--text-secondary)] font-medium text-sm mb-4">0 € / 600 €</p>
                        
                        <!-- Leerer Balken -->
                        <div class="h-2 w-full bg-[var(--bg-primary)] rounded-full overflow-hidden relative border border-[var(--glass-border)]">
                            <div class="h-full bg-[var(--text-secondary)] w-[0%]"></div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- Timeline Section -->
            <section id="roadmap-section" class="mb-24 fade-in-section" style="--delay: 0.3s;">
                <h2 class="text-2xl md:text-3xl font-medium text-[var(--accent-gold)] text-center mb-16 tracking-wide">Unsere Roadmap</h2>
                
                <div class="relative pl-4 sm:pl-10 py-2">
                    <div class="roadmap-line-container">
                        <div class="roadmap-progress-line" id="progress-line"></div>
                    </div>
                    <!-- Timeline Item 1 -->
                    <div class="mb-14 relative roadmap-item" data-index="1">
                        <div class="absolute -left-1 sm:-left-1 top-0 flex items-center justify-center">
                            <div class="w-8 h-8 sm:w-12 sm:h-12 bg-[var(--bg-primary)] rounded-full border-2 border-[var(--text-secondary)] z-10 flex items-center justify-center text-[var(--text-secondary)] font-bold roadmap-dot transition-colors">1</div>
                        </div>
                        <div class="ml-12 sm:ml-20 glass-container p-6 sm:p-8 rounded-2xl opacity-80 hover:opacity-100 transition-opacity">
                            <h3 class="text-xl sm:text-2xl font-medium text-[var(--text-primary)] mb-3">Start der Community</h3>
                            <p class="text-[var(--text-secondary)] text-sm sm:text-base leading-relaxed">Der offizielle Start unserer Sadaqa-Initiative ist für Rabi' al-Thani 1447 in sha ALLAH geplant. Wir beginnen mit der Sammlung der ersten monatlichen Beiträge.</p>
                        </div>
                    </div>
                    <!-- Timeline Item 2 -->
                    <div class="mb-14 relative roadmap-item" data-index="2">
                        <div class="absolute -left-1 sm:-left-1 top-0 flex items-center justify-center">
                            <div class="w-8 h-8 sm:w-12 sm:h-12 bg-[var(--bg-primary)] rounded-full border-2 border-[var(--text-secondary)] z-10 flex items-center justify-center text-[var(--text-secondary)] font-bold roadmap-dot transition-colors duration-500">2</div>
                        </div>
                        <div class="ml-12 sm:ml-20 glass-container p-6 sm:p-8 rounded-2xl opacity-80 hover:opacity-100 transition-opacity">
                            <h3 class="text-xl sm:text-2xl font-medium text-[var(--text-primary)] mb-3 transition-colors duration-500">Erstes Projekt</h3>
                            <p class="text-[var(--text-secondary)] text-sm sm:text-base leading-relaxed">Nach dem erfolgreichen Start in sha ALLAH, werden wir gemeinsam das erste Projekt auswählen, das wir unterstützen möchten.</p>
                        </div>
                    </div>
                    <!-- Timeline Item 3 (AKTIV) -->
                    <div class="relative roadmap-item" data-index="3">
                        <div class="absolute -left-1 sm:-left-1 top-0 flex items-center justify-center">
                            <div class="w-8 h-8 sm:w-12 sm:h-12 rounded-full border-2 border-[var(--accent-gold)] z-10 flex items-center justify-center text-[var(--bg-primary)] bg-[var(--accent-gold)] font-bold roadmap-dot pulse-active-dot">3</div>
                        </div>
                        <div class="ml-12 sm:ml-20 glass-container p-6 sm:p-8 rounded-2xl border-l-4 border-l-[var(--accent-gold)] shadow-[0_4px_20px_var(--card-hover)]">
                            <h3 class="text-xl sm:text-2xl font-medium text-[var(--accent-gold)] mb-3">Laufende Unterstützung</h3>
                            <p class="text-[var(--text-secondary)] text-sm sm:text-base leading-relaxed">In sha ALLAH werden wir weiterhin monatlich spenden und neue Wege finden, um Gutes zu tun.</p>
                        </div>
                    </div>
                </div>
            </section>
            <!-- Aufruf Section -->
            <section class="special-callout-container p-8 md:p-12 rounded-3xl mb-24 fade-in-section" style="--delay: 0.4s;" id="callout-section">
                <div class="text-center mb-10">
                    <span class="text-[var(--accent-gold)] uppercase tracking-widest text-xs font-bold border-b border-[var(--accent-gold)] pb-1">Ein Aufruf</span>
                    <h2 class="text-xl md:text-2xl font-medium text-[var(--text-primary)] mt-6 leading-relaxed max-w-2xl mx-auto font-serif">
                        Einige ausgewählte Worte aus dem Qur'an und der Sunnah, die zur Spende ermutigen:
                    </h2>
                </div>
                
                <div class="space-y-12 md:space-y-16" id="callout-texts">
                    <!-- Dynamic content filled by JS -->
                </div>
            </section>
            <!-- Projects Section (Carousel) -->
            <section class="fade-in-section relative group/slider mb-24" style="--delay: 0.5s;">
                <h2 class="text-2xl md:text-3xl font-medium text-[var(--accent-gold)] mb-8 flex items-center justify-center md:justify-start">
                    <svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    Abgeschlossene Projekte
                </h2>
                
                <button id="slide-left" aria-label="Vorheriges Projekt" class="absolute -left-5 top-1/2 -translate-y-1/2 z-30 p-3 rounded-full bg-[var(--glass-bg)] border border-[var(--glass-border)] text-[var(--accent-gold)] opacity-0 group-hover/slider:opacity-100 transition-all hidden md:flex hover:bg-[var(--accent-gold)] hover:text-[var(--bg-primary)] hover:scale-110 backdrop-blur-md">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                </button>
                <button id="slide-right" aria-label="Nächstes Projekt" class="absolute -right-5 top-1/2 -translate-y-1/2 z-30 p-3 rounded-full bg-[var(--glass-bg)] border border-[var(--glass-border)] text-[var(--accent-gold)] opacity-0 group-hover/slider:opacity-100 transition-all hidden md:flex hover:bg-[var(--accent-gold)] hover:text-[var(--bg-primary)] hover:scale-110 backdrop-blur-md">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                </button>
                <div id="projects-slider" class="flex overflow-x-auto snap-x snap-mandatory gap-6 pb-6 no-scrollbar scroll-smooth px-2">
                    <!-- Cards via JS -->
                </div>
                
                <div class="text-center mt-4 md:hidden flex justify-center items-center gap-2 text-[var(--text-secondary)] opacity-60">
                    <svg class="w-4 h-4 animate-bounce-x" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                    <span class="text-xs font-medium uppercase tracking-wider">Wischen für mehr</span>
                    <svg class="w-4 h-4 animate-bounce-x-reverse" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
                </div>
            </section>
            
            <!-- FAQ Section -->
            <section class="fade-in-section mb-20" style="--delay: 0.6s;">
                <div class="flex items-center justify-center md:justify-start mb-10">
                    <h2 class="text-2xl md:text-3xl font-medium text-[var(--accent-gold)] flex items-center">
                        <svg class="w-7 h-7 mr-3 text-[var(--accent-gold)]" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        Häufige Fragen
                    </h2>
                </div>
                <div id="faq-container" class="space-y-4">
                    <!-- Dynamic FAQ content filled by JS -->
                </div>
            </section>
            
            <!-- Share Section -->
            <section class="text-center py-16 border-t border-[var(--glass-border)] fade-in-section" style="--delay: 0.7s;">
                <h2 class="text-2xl md:text-3xl font-medium text-[var(--accent-gold)] mb-6 font-serif">Teile die Initiative</h2>
                <p class="text-[var(--text-secondary)] text-sm md:text-base max-w-lg mx-auto mb-10 leading-relaxed">
                    „[...] Wer auf Gutes hinweist, erhält den gleichen Lohn wie derjenige, der es tut."
                    <span class="block text-[var(--accent-gold)] mt-2 font-serif text-sm opacity-80">[Sahih Muslim - 1893]</span>
                </p>
                <button id="copy-link-btn" aria-label="Link kopieren" class="group relative inline-flex items-center justify-center px-10 py-4 text-base font-semibold text-[var(--bg-primary)] bg-[var(--accent-gold)] rounded-full overflow-hidden transition-all duration-300 hover:opacity-90 hover:shadow-[0_0_30px_rgba(212,175,55,0.4)] hover:-translate-y-1">
                    <span class="relative z-10 flex items-center">
                        Link kopieren
                        <svg class="ml-3 w-5 h-5 group-hover:translate-x-2 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                    </span>
                </button>
            </section>
            
            <footer class="text-center text-[var(--text-secondary)] text-sm mt-12 pb-8 opacity-70">
                <p>SANAABIL &copy; 1447 AH</p>
            </footer>
        </main>
        <!-- Toast Message -->
        <div id="toast-message" class="toast fixed bottom-8 left-1/2 -translate-x-1/2 px-6 py-4 bg-[var(--bg-primary)] border border-[var(--accent-gold)] rounded-full shadow-2xl transition-all duration-500 ease-out opacity-0 translate-y-8 pointer-events-none z-50 flex items-center gap-3">
            <svg class="w-5 h-5 text-[var(--accent-gold)]" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
            <span class="text-sm font-medium text-[var(--text-primary)]">Link in die Zwischenablage kopiert</span>
        </div>
    </div>
    <!-- Tailwind Custom Animations -->
    <style>
        @keyframes bounce-x { 0%, 100% { transform: translateX(0); } 50% { transform: translateX(-25%); } }
        @keyframes bounce-x-reverse { 0%, 100% { transform: translateX(0); } 50% { transform: translateX(25%); } }
        .animate-bounce-x { animation: bounce-x 1.5s infinite; }
        .animate-bounce-x-reverse { animation: bounce-x-reverse 1.5s infinite; }
    </style>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- THEME TOGGLE LOGIC ---
            const toggle = document.getElementById('theme-toggle');
            const body = document.body;
            
            toggle.addEventListener('change', () => {
                body.classList.toggle('light-mode', toggle.checked);
            });
            // --- DATA ARRAYS ---
            const calloutData = [
                { text: 'O die ihr glaubt, gebt aus von dem, womit Wir euch versorgt haben, bevor ein Tag kommt, an dem es keinen Verkauf, keine Freundschaft und keine Fürsprache gibt! Die Ungläubigen sind die Ungerechten.', source: '[Qur\'an - 2:254]' },
                { text: 'Diejenigen, die ihren Besitz auf Allahs Weg ausgeben und hierauf dem, was sie ausgegeben haben, weder Vorhaltungen noch Beleidigungen nachfolgen lassen, die haben ihren Lohn bei ihrem Herrn, und keine Furcht soll über sie kommen, noch sollen sie traurig sein.', source: '[Qur\'an - 2:262]' },
                { text: 'Glaubt an Allah und Seinen Gesandten und gebt aus von dem, worüber Er euch zu Statthaltern eingesetzt hat. Diejenigen von euch, die glauben und ausgeben, für sie wird es großen Lohn geben.', source: '[Qur\'an: 57:7]' },
                { text: 'Und was ist mit euch, daß ihr nicht auf Allahs Weg ausgeben sollt, wo doch das Erbe der Himmel und der Erde Allah gehört.[..]', source: '[Qur\'an - 57:10]' },
                { text: '[..]„Wohlstand wird nicht durch Spenden verringert, und Allah mehrt einem Diener durch Vergebung nur an Ehre, und niemand demütigt sich vor Allah, außer dass Allah ihn erhöht.“', source: '[Sahih Muslim - 2588]' },
                { text: '[..]„Allah hat gesagt: "Gib aus, o Sohn Adams, und Ich werde für dich ausgeben."“', source: '[Sahih al-Bukhari - 5352]' }
            ];
            const projectsData = [
                { title: 'Brunnen Reparatur', location: 'Afghanistan', amount: '507,03 €', iconPath: 'M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2.5L8 2.69 9.31 4H20a2 2 0 0 1 2 2v2.5M12 21.5a8.38 8.38 0 0 0 2.5-1.95L12 17l-2.5 2.55A8.38 8.38 0 0 0 12 21.5z', bgIcon: 'M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z' },
                { title: 'Unterstützung eines Bruders', location: 'Gambia', amount: '166,00 €', iconPath: 'M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z', bgIcon: 'M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z' },
                { title: 'Nothilfe Gaza-Nahost', location: 'Palästina', amount: '493,00 €', iconPath: 'M12 5v10m0 4h.01', bgIcon: 'M12 4v11m0 4h.01', isStroke: true },
                { title: 'Unterstützung eines Bruders', location: 'Deutschland', amount: '400,00 €', iconPath: 'M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z', bgIcon: 'M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z' },
                { title: 'Unterstützung Hochzeit', location: 'Gambia', amount: '225,91 €', iconPath: 'M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z', bgIcon: 'M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z' }
            ];
            const faqData = [
                { q: "Wie kann ich teilnehmen?", a: "Die Teilnahme an unserer Initiative erfolgt über den Gruppen-Link, der von einem bestehenden Mitglied geteilt wird. Dort können Sie sich mit der Community verbinden, um Ihren monatlichen Beitrag von 1 € für die Bedürftigen zu leisten." },
                { q: "Wofür werden Spenden verwendet?", a: "Die gesammelten Beiträge werden ausschließlich für die Unterstützung von Bedürftigen eingesetzt, in sha ALLAH. Der genaue Verwendungszweck wird in der Community transparent kommuniziert." },
                { q: "Bedeutung des Namens \"SANAABIL\"?", a: "\"SANAABIL\" (arabisch für Ähren) bezieht sich auf das Gleichnis im Qur'an (2:261), in dem eine Spende auf ALLAHs Weg mit einem Saatkorn verglichen wird, aus dem sieben Ähren wachsen, wobei jede Ähre hundert Körner trägt. Der Name erinnert daran, dass selbst die kleinste aufrichtige Gabe um ALLAHs willen zu einem großen, segensreichen Handel heranwachsen kann." },
                { q: "Wie werden Projekte ausgewählt?", a: "Die Auswahl erfolgt in Absprache innerhalb der Community. Informationen zu den jeweiligen Spendenprojekten werden in der Community bereitgestellt." },
                { q: "Gibt es eine Übersicht über die Beträge?", a: "Ja, eine transparente Übersicht über die gesammelten und gespendeten Beträge wird am Ende des Monats oder auf Anfrage bereitgestellt. Dies dient dazu, die Nachvollziehbarkeit und das Vertrauen innerhalb der Community zu gewährleisten." },
                { q: "Ist die Teilnahme bindend?", a: "Nein, die Teilnahme ist absolut freiwillig. Sie können die monatliche Spende jederzeit stoppen, indem Sie einem der Ansprechpartner Bescheid geben." },
                { q: "Wie wird das Geld (Amana) verwendet?", a: "Jeder gespendete Betrag ist für uns eine Amana – ein uns von ALLAH anvertrautes Gut. Die korrekte Verwendung wird durch interne Rücksprache und eine sorgfältige Dokumentation sichergestellt." },
                { q: "Gibt es Bilder oder Videos als Nachweis?", a: "Ja, entsprechende Nachweise werden intern in der Gruppe geteilt. Auf Wunsch können diese auch privat zur Verfügung gestellt werden, um Transparenz zu gewährleisten und gleichzeitig die Privatsphäre zu wahren." }
            ];
            // --- DOM POPULATION ---
            
            // Populate Callouts
            const calloutContainer = document.getElementById('callout-texts');
            calloutContainer.innerHTML = calloutData.map(item => `
                <div class="callout-item relative pl-6 md:pl-8 border-l-2 border-[var(--accent-gold)] opacity-80 hover:opacity-100 transition-opacity duration-300">
                    <blockquote class="quote-text mb-4">"${item.text}"</blockquote>
                    <p class="text-xs md:text-sm text-[var(--accent-gold)] font-serif tracking-widest uppercase text-right opacity-90">${item.source}</p>
                </div>
            `).join('');

            // Populate Projects
            const slider = document.getElementById('projects-slider');
            slider.innerHTML = projectsData.map((p, i) => `
                <div class="snap-center flex-shrink-0 w-[85%] sm:w-[320px] group relative overflow-hidden rounded-2xl bg-[var(--glass-bg)] border border-[var(--glass-border)] transition-all duration-300 hover:shadow-[0_10px_30px_var(--card-hover)] hover:-translate-y-1">
                    <div class="absolute -right-6 -top-6 text-[var(--accent-gold)] opacity-[0.03] transform ${i%2===0?'rotate-12':'-rotate-6'} group-hover:scale-110 transition-transform duration-700">
                        <svg class="w-32 h-32" ${p.isStroke ? 'fill="none" stroke="currentColor"' : 'fill="currentColor"'} viewBox="0 0 24 24"><path ${p.isStroke ? 'stroke-linecap="round" stroke-linejoin="round" stroke-width="3"' : ''} d="${p.bgIcon}"></path></svg>
                    </div>
                    <div class="p-6 md:p-8 relative z-10 flex flex-col h-full">
                        <div class="w-14 h-14 rounded-full border border-[var(--glass-border)] bg-[var(--bg-primary)] shadow-sm flex items-center justify-center mb-5 text-[var(--accent-gold)] group-hover:bg-[var(--accent-gold)] group-hover:text-[var(--bg-primary)] transition-all duration-300">
                            <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${p.iconPath}"></path></svg>
                        </div>
                        <h3 class="text-xl font-semibold text-[var(--text-primary)] mb-1 group-hover:text-[var(--accent-gold)] transition-colors">${p.title}</h3>
                        <p class="text-sm text-[var(--text-secondary)] font-serif italic mb-6">${p.location}</p>
                        <div class="mt-auto pt-5 border-t border-[var(--glass-border)] flex flex-col gap-2">
                            <div>
                                <p class="text-[var(--text-secondary)] text-[10px] font-semibold uppercase tracking-widest mb-1">Gespendet</p>
                                <p class="text-[var(--text-primary)] font-bold text-xl">${p.amount}</p>
                            </div>
                            <div class="mt-2">
                                <span class="inline-flex items-center px-3 py-1.5 rounded-full text-[10px] font-bold uppercase tracking-wide bg-[var(--success-bg)] text-[var(--success-text)] border border-[var(--success-border)] w-full">
                                    <svg class="mr-1.5 h-3 w-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>
                                    Erfolgreich
                                    <span class="ml-1 opacity-75 font-serif normal-case tracking-normal text-xs flex-1 text-right">| wa lillahi-l hamd</span>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="project-shine"></div>
                </div>
            `).join('');

            // Populate FAQ
            const faqContainer = document.getElementById('faq-container');
            faqContainer.innerHTML = faqData.map((f, i) => `
                <div class="faq-item cursor-pointer group" tabindex="0" role="button" aria-expanded="false">
                    <div class="flex justify-between items-center p-5 md:p-6">
                        <span class="text-[var(--text-primary)] font-medium text-base md:text-lg"><span class="text-[var(--accent-gold)] font-bold mr-3 opacity-80">${i+1}.</span>${f.q}</span>
                        <svg class="faq-icon w-6 h-6 text-[var(--text-secondary)] group-hover:text-[var(--accent-gold)]" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </div>
                    <div class="faq-content-wrapper">
                        <div class="faq-content px-5 md:px-6">
                            <p class="text-[var(--text-secondary)] text-sm md:text-base leading-relaxed border-t border-[var(--glass-border)] pt-4 pb-5">
                                ${f.a}
                            </p>
                        </div>
                    </div>
                </div>
            `).join('');

            // --- INTERACTION LOGIC ---
            // Loader Hide Logic
            window.addEventListener('load', function() {
                const loader = document.getElementById('loader-container');
                const content = document.getElementById('content-container');
                setTimeout(() => {
                    loader.classList.add('opacity-0');
                    setTimeout(() => {
                        loader.style.display = 'none';
                        content.classList.remove('hidden');
                        requestAnimationFrame(() => content.classList.remove('opacity-0'));
                    }, 700);
                }, 500); 
            });

            // General Fade-In Observer
            const observer = new IntersectionObserver((entries, obs) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        obs.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });
            document.querySelectorAll('.fade-in-section').forEach(el => observer.observe(el));

            // Ramadan Status Progress Bar Observer
            const ramadanSection = document.getElementById('ramadan-status-section');
            const progressBars = document.querySelectorAll('.ramadan-progress-fill');
            
            if(ramadanSection && progressBars.length > 0) {
                const ramadanObserver = new IntersectionObserver((entries) => {
                    if (entries[0].isIntersecting) {
                        progressBars.forEach(bar => {
                            setTimeout(() => {
                                bar.style.width = bar.getAttribute('data-target');
                            }, 500);
                        });
                        ramadanObserver.disconnect();
                    }
                }, { threshold: 0.3 });
                ramadanObserver.observe(ramadanSection);
            }

            // Roadmap Specific Observer
            const roadmapSection = document.getElementById('roadmap-section');
            const progressLine = document.getElementById('progress-line');
            const roadmapItems = document.querySelectorAll('.roadmap-item');
            
            if(roadmapSection && progressLine) {
                const roadmapObserver = new IntersectionObserver((entries) => {
                    if (entries[0].isIntersecting) {
                        progressLine.style.height = '100%';
                        roadmapItems.forEach((item, index) => {
                            setTimeout(() => {
                                item.classList.add('active');
                            }, index * 500 + 200);
                        });
                        roadmapObserver.disconnect();
                    }
                }, { threshold: 0.2 });
                roadmapObserver.observe(roadmapSection);
            }

            // FAQ Logic
            faqContainer.addEventListener('click', (e) => {
                const item = e.target.closest('.faq-item');
                if (!item) return;
                const isActive = item.classList.contains('active');
                
                document.querySelectorAll('.faq-item').forEach(el => {
                    el.classList.remove('active');
                    el.setAttribute('aria-expanded', 'false');
                });
                
                if (!isActive) {
                    item.classList.add('active');
                    item.setAttribute('aria-expanded', 'true');
                }
            });

            // Slider Buttons
            document.getElementById('slide-left').addEventListener('click', () => {
                slider.scrollBy({ left: -window.innerWidth * 0.8, behavior: 'smooth' });
            });
            document.getElementById('slide-right').addEventListener('click', () => {
                slider.scrollBy({ left: window.innerWidth * 0.8, behavior: 'smooth' });
            });

            // Copy Link
            document.getElementById('copy-link-btn').addEventListener('click', async () => {
                const text = "Eine Initiative die mit wenig viel erreichen will in sha ALLAH -- SANAABIL: https://blu3oceanwaves.github.io/SANAABIL/";
                try { await navigator.clipboard.writeText(text); } catch (err) { /* fallback */ }
                
                const toast = document.getElementById('toast-message');
                toast.classList.remove('opacity-0', 'translate-y-8');
                setTimeout(() => toast.classList.add('opacity-0', 'translate-y-8'), 3500);
            });

            // --- OPTIMIZED CANVAS PARTICLES ---
            const canvas = document.getElementById('particle-canvas');
            const ctx = canvas.getContext('2d');
            const TWO_PI = Math.PI * 2;
            let particles = [];
            let isAnimating = false;
            let animationFrameId;

            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }

            let resizeTimeout;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    resizeCanvas();
                    initParticles();
                }, 200);
            });
            
            resizeCanvas();

            class Particle {
                constructor() { this.reset(); }
                reset() {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height;
                    this.size = Math.random() * 2 + 0.5;
                    this.speedX = (Math.random() - 0.5) * 0.3;
                    this.speedY = (Math.random() - 0.5) * 0.3;
                    this.opacity = Math.random() * 0.4 + 0.1;
                }
                update() {
                    this.x += this.speedX;
                    this.y += this.speedY;
                    if (this.x > canvas.width || this.x < 0) this.speedX *= -1;
                    if (this.y > canvas.height || this.y < 0) this.speedY *= -1;
                }
                draw(colorStr) {
                    ctx.fillStyle = `rgba(${colorStr}, ${this.opacity})`;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size, 0, TWO_PI);
                    ctx.fill();
                }
            }

            function initParticles() {
                particles = [];
                const num = window.innerWidth < 768 ? 25 : 50; 
                for (let i = 0; i < num; i++) particles.push(new Particle());
            }

            function animateParticles() {
                if (!isAnimating) return;
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                const colorString = getComputedStyle(document.body).getPropertyValue('--particle-color').trim();
                
                for(let i=0; i<particles.length; i++){
                    particles[i].update();
                    particles[i].draw(colorString);
                }
                animationFrameId = requestAnimationFrame(animateParticles);
            }

            const canvasObserver = new IntersectionObserver((entries) => {
                if (entries[0].isIntersecting) {
                    if(!isAnimating) {
                        isAnimating = true;
                        initParticles();
                        animateParticles();
                    }
                } else {
                    isAnimating = false;
                    cancelAnimationFrame(animationFrameId);
                }
            }, { threshold: 0 });
            
            canvasObserver.observe(document.body);
        });
    </script>
</body>
</html>
